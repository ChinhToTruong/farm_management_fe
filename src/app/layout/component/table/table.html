<p-toolbar styleClass="mb-6">
    <ng-template #start>
        <p-button label="New" icon="pi pi-plus" severity="secondary" class="mr-2" (onClick)="openNew()" />
        <p-button severity="secondary" label="Delete" icon="pi pi-trash" outlined (onClick)="onDeleteList()" [disabled]="!selectedItems || !selectedItems.length" />
    </ng-template>

    @if (showExport) {
        <ng-template #end>
            <p-button label="Export" icon="pi pi-upload" severity="secondary" (onClick)="exportCSV()" />
        </ng-template>
    }
</p-toolbar>
<p-table
    #dt
    [value]="data"
    [rows]="5"
    [columns]="columns"
    [paginator]="paginator"
    (onPage)="onPageChange($event)"
    [tableStyle]="{ 'min-width': '75rem' }"
    [paginatorPosition]="'top'"
    [(selection)]="selectedItems"
    (selectionChange)="onSelectionChange($event)"
    [rowHover]="rowHover"
    [dataKey]="id"
    [totalRecords]="total"
    currentPageReportTemplate="Showing {first} to {last} of {totalRecords}"
    [showCurrentPageReport]="true"
    [rowsPerPageOptions]="rowsPerPageOptions"
    class="my-table"
>
    <ng-template #caption>
        <div class="flex items-center justify-between">
            <h5 class="m-0">{{ title }}</h5>
            <p-iconfield>
                <p-inputicon class="pi pi-search" />
                <input #searchInput pInputText type="text" (input)="onGlobalFilter($event)" placeholder="Search..." />
            </p-iconfield>
        </div>
    </ng-template>
    <ng-template #header>
        <tr>
            <!-- Checkbox chọn tất cả -->
            <th style="width: 3rem" class="sticky-left">
                <p-tableHeaderCheckbox/>
            </th>
            <!-- Sinh các cột từ mảng columns -->
            @for (col of columns; track col.field){
                <th [pSortableColumn]="col.sortable ? col.field : undefined" [style.min-width.px]="col.minWidth || 120">
                    {{ col.header }}
                    @if (col.sortable){
                        <p-sortIcon [field]="col.field"></p-sortIcon>
                    }
                </th>
            }

            <!-- Cột actions -->
            <th style="width: 60px" class="sticky-right">Action</th>
        </tr>
    </ng-template>
    <ng-template #body let-rowData let-columns="columns">
            <tr>
                <!-- Checkbox chọn row -->
                <td style="width: 3rem" class="sticky-left">
                    <p-tableCheckbox [value]="rowData"/>
                </td>

                <!-- Sinh các cột tự động -->
                <td *ngFor="let column of columns">

                    <ng-container [style]="{width: column.width}">
                        <span>{{ rowData[column.field] }}</span>
                    </ng-container>
                </td>

                <!-- Action buttons -->
                <td style="width: 60px" class="sticky-right">
                    <p-button icon="pi pi-pencil" class="mr-2" outlined (click)="onEdit(rowData)"></p-button>
                    <p-button icon="pi pi-trash" severity="danger" outlined (click)="onDelete(rowData)"></p-button>
                </td>
            </tr>

    </ng-template>

</p-table>

